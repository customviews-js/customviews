<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CustomViews - Native HTML Demo</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial; padding: 24px; }
      header { margin-bottom: 16px; }
      .controls { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px; }
      .status { margin-top: 12px; font-size: 0.9rem; color: #333; }
      .demo-pane { border: 1px solid #e0e0e0; padding: 12px; border-radius: 6px; margin-bottom: 12px; }
      .cv-hidden { display: none !important; }
      .cv-visible { display: block !important; }
      /* basic styles for tab nav produced by TabManager */
      .cv-tabs-nav { list-style: none; padding: 0; display: flex; gap: 8px; margin: 0 0 8px 0; }
  .cv-tabs-nav .nav-item { display: block; }
      .cv-tabs-nav .nav-link { display: inline-block; padding: 6px 10px; border-radius: 4px; text-decoration: none; color: #333; border: 1px solid transparent; }
      .cv-tabs-nav .nav-link.active { background: #0366d6; color: white; border-color: #0366d6; }
    </style>
  </head>
  <body>
    <header>
      <h1>CustomViews — Native HTML demo</h1>
      <p>A small demo that shows toggles and tabs using the <code>custom-views</code> runtime.</p>
    </header>

    <!-- Include the requested script tag exactly as specified -->
    <script src="../dist/custom-views.min.js" data-base-url="/demo"></script>

    <section class="demo-pane">
      <strong>Toggle-controlled content</strong>
      <div style="margin-top:8px">
        <div data-cv-toggle="windows" style="padding:8px; border:1px dashed #cfcfcf; margin-bottom:8px">
          <strong>Windows view</strong>
          <p>This content is shown when the <code>windows</code> toggle is active.</p>
        </div>

        <div data-cv-toggle="mac" style="padding:8px; border:1px dashed #cfcfcf; margin-bottom:8px">
          <strong>Mac view</strong>
          <p>This content is shown when the <code>mac</code> toggle is active.</p>
        </div>

        <div data-cv-toggle="linux" style="padding:8px; border:1px dashed #cfcfcf; margin-bottom:8px">
          <strong>Linux view</strong>
          <p>This content is shown when the <code>linux</code> toggle is active.</p>
        </div>
      </div>
    </section>

    <section class="demo-pane">
      <strong>Tabs</strong>
      <!-- Tab group: TabManager will build the nav and manage selections -->
      <cv-tabgroup id="demo-tabs">
        <cv-tab id="tabA" header="Alpha">
          <p><strong>Alpha</strong> — content for tab A.</p>
        </cv-tab>
        <cv-tab id="tabB" header="Beta">
          <p><strong>Beta</strong> — content for tab B.</p>
        </cv-tab>
        <cv-tab id="tabC" header="Gamma">
          <p><strong>Gamma</strong> — content for tab C.</p>
        </cv-tab>
      </cv-tabgroup>

      <cv-tabgroup id="demo-tabs">
        <cv-tab id="tabA" header="Second Alpha">
          <p><strong>Alpha</strong> — content for tab A.</p>
        </cv-tab>
        <cv-tab id="tabB" header="Second Beta">
          <p><strong>Beta</strong> — content for tab B.</p>
        </cv-tab>
        <cv-tab id="tabC" header="Second Gamma">
          <p><strong>Gamma</strong> — content for tab C.</p>
        </cv-tab>
      </cv-tabgroup>

    <script>
      // Wait for the library's ready event. The library auto-initializes when loaded via script tag.
      function $(id) { return document.getElementById(id); }

      document.addEventListener('customviews:ready', function (ev) {
        const core = window.customViewsInstance && window.customViewsInstance.core;
        if (!core) {
          console.error('CustomViews core not available');
          return;
        }

        // Utility to refresh status display
        function refreshStatus() {
          try {
            const toggles = core.getCurrentActiveToggles();
            $('status-toggles').textContent = 'Active toggles: ' + (toggles.length ? toggles.join(', ') : '(none)');

            const tabs = core.getCurrentActiveTabs();
            $('status-tabs').textContent = 'Active tabs: ' + JSON.stringify(tabs);
          } catch (err) {
            console.warn('Error reading core state', err);
          }
        }

        // Listen for state changes and refresh initial status
        core.addStateChangeListener(refreshStatus);
        refreshStatus();
      });

      // If the library was already initialized before this script runs, the event may have fired.
      // Try a short deferred check in that case.
      setTimeout(() => {
        if (window.customViewsInstance && window.customViewsInstance.core) {
          const ev = new CustomEvent('customviews:ready', { detail: { core: window.customViewsInstance.core, widget: window.customViewsInstance.widget } });
          document.dispatchEvent(ev);
        }
      }, 50);
    </script>
  </body>
</html>
